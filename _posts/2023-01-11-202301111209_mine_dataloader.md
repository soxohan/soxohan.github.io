---
layout: post
title: "Code-DataLoader"
category: my_progress
changefreq : daily
priority : 1.0
comments : true
permalink : /:categories/:year/:month/:day/:title/
math_use : true
sitemap : false

---

~~ë¹ ë¥´ê²Œ ì§œë´…ì‹œë‹¤ì•„~~

ğŸ—“ï¸ 2023.01.10 ~ 2023.01.11

ëŒ€ëµì ìœ¼ë¡œ ì‹¤í–‰ì€ sh íŒŒì¼ + yamlìœ¼ë¡œ ê° ëª¨ë¸ì— ëŒ€í•œ íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°

.. ì •ë„ë¡œ í•´ë³¼ìƒê°ì´ë‹¤.

<br>

data loaderë¥¼ ì§œëŠ”ë°, ë°ì´í„°ë§ˆë‹¤ shapeì´ ë„ˆë¬´ ë‹¬ë¼ì„œ ì¡°ê¸ˆ ê¸°ë¡í•´ì•¼ í•  í•„ìš”ì„±ì„ ëŠê¼ˆë‹¤.

ìš°ì„  ê°€ì¥ ì§§ì€ NAB ë¨¼ì € ì„ íƒ!

---

### NAB

train/test/label shapeì€ (???, 1)ì˜ í˜•íƒœ (í¬ê¸° ë˜í•œ ëª¨ë‘ ê°™ë‹¤. ë‚´ê°€ trainì´ë‘ test ë°ì´í„° ë™ì¼í•˜ê²Œ ë„£ì—ˆìœ¼ë‹ˆê¹Œ..)

ë‚˜ì¤‘ì— ì •í•´ì•¼í•  ë¶€ë¶„ì´ë¼ì„œ, ìš°ì„  7ê°œì˜ ë°ì´í„°ë¥¼ ëª¨ë‘ ê³ ë ¤í•´ì„œ ë°ì´í„°ë¡œë”ë¥¼ ì§œë†”ì•¼ í•  ê²ƒ ê°™ë‹¤.

ê·¸ëŸ¬ë©´ ìš°ì„  ë‚˜ì¤‘ì— ì„ íƒí•  ìˆ˜ë„ ìˆìœ¼ë‹ˆ get_args.pyì—ëŠ” ë°ì´í„° ì„ íƒì„ í•˜ë„ë¡ í•´ë†”ì•¼ì§€! 

~~ì•„....................... NAB ë°ì´í„°ê°€ ì›ë˜ time stampê°€ ìˆëŠ”ë°, ê·¸ê±¸ ì‚´ë ¤ì•¼í•˜ëŠ”ì§€ ê³ ë¯¼ì„ í•´ë³´ì•¼ í• ë“¯.. ë‹¤ë¥¸ ë°ì´í„°ëŠ” ì—†ì–´ì„œ ë„£ì§€ ì•Šê³  ì €ì¥ì„ í•´ë†“ì•˜ëŠ”ë°, í•„ìš”í•  ìˆ˜ë„ ìˆìœ¼ë ¤ë‚˜??~~

<br>

ìƒê°ì„ í•´ë´¤ì„ë•Œ ğŸ˜Ÿ, ì—¬ê¸°ì„œ concat í•´ë²„ë¦¬ë©´ ë‚˜ì¤‘ì— ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ì—ì„œ ë¬¸ì œê°€ ìƒê¸°ì–ì•„..?! 

ê·¸ë‹ˆê¹Œ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•´ë†“ê³ , getitemì—ì„œ ê±°ê¸°ì„œ ëŒë ¤ì„œ ìƒì„±ì‹œí‚¤ëŠ” ë°©ë²•ì„ ìƒê°ì¦..ì´ë‹¤

ì´ê±° í•˜ë‚˜ ì§œë†“ìœ¼ë©´, ë‹¤ë¥¸ ê²ƒë„ ë™ì¼í•˜ê²Œ í•˜ë©´ ë  ê²ƒ ê°™ì•„ì„œ, íš¨ìœ¨ì ì¸ ë°©ë²•ì´ ì—†ìœ¼ë ¤ë‚˜ ğŸ˜‘ğŸ˜‘ğŸ˜‘

<br>

dataset1ì—ì„œ ì¢‹ì•„ë³´ì´ë˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆëŠ”ë°, ë­”ê°€ ì´ìƒí•˜ë‹¤.

step_lenì˜ ì‚¬ìš©ì´ ìœ„ì˜ forë¬¸ì— ë“¤ì–´ê°€ëŠ”ê²Œ ë§ì•„ë³´ì—¬ì„œ.. ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•œë‹¤!! ~~ì™œì§€ ì´ ì°ì°í•¨..~~

```python
datas = []
start_index = 0
end_index = len(data) - seq_len + 1

for j in range(start_index, end_index, step_len):
    indices = range(j, j+seq_len)
    datas.append(data[indices])
```

<br>

modeì— ë”°ë¼ loadí•˜ëŠ” ë°ì´í„°ê°€ ë‹¤ë¥´ë©´,

mode == trainì´ë©´ x ë°ì´í„°ê°€ train / y ë°ì´í„°ê°€ ì—†ìŒ

mode == testì´ë©´ x ë°ì´í„°ê°€ test / y ë°ì´í„°ê°€ label

ì´ëŸ° ì‹ìœ¼ë¡œ ì²˜ë¦¬ë¥¼ í•´ì•¼í•  ê²ƒë§Œ ê°™ë„¹  â†’ ê·¸ëŸ¬ë©´ trainìš© í•¨ìˆ˜ / testìš© í•¨ìˆ˜ë¥¼ ë¶„ë¦¬í•˜ì. ~~ì¢‹ì€ ë°©ë²•ì´ ìˆë‹¤ë©´ ì–¸ì œë“  ë°”ë€” ìˆ˜ ìˆë‹¤!!!~~

---

### SMAP & MSL & SMD

ë™ì¼!

---

ğŸ™ íŒŒì¼ì´ë¦„ì„ ë‹¤ ì§€ì •í•  ìƒê°ì€ ì—†ì—ˆë‹¤. choice_dataê°€ ìˆìœ¼ë©´ ê·¸ê±¸ë¡œ ì§€ì •í•˜ê³ , ì—†ìœ¼ë©´ Noneìœ¼ë¡œ ì…ë ¥ë°›ê²Œ í•´ì•¼ê² ë‹¤..

ğŸ™ trainì€ ê°™ë”ë¼ë„ ë¼ë²¨ì—ì„œëŠ” ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŒ! ë¼ë²¨ì„ ìˆ˜ì •í•´ì•¼í•¨!

ğŸ™ ê° ë°ì´í„°ì— í•´ë‹¹ choice_dataê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì ˆì°¨ë¥¼ ì¶”ê°€í•´ì•¼í•  ê²ƒ ê°™ë‹¤.

ğŸ™ WADI ë°ì´í„°ë§Œ ë‚´ê°€ pandas í˜•íƒœì—ì„œ ì €ì¥í•´ë²„ë ¸ë‹¤. ë°ì´í„°ì…‹ì„ ìˆ˜ì •í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.



ê¸°ë¡ì€ í•´ë‘¬ì•¼ í•  ê²ƒ ê°™ìœ¼ë‹ˆ..

```python
parser.add_argument("--dataset", default='NAB', choices=['MSL', 'NAB', 'SMAP', 'SMD', 'WADI'])
if parser.parse_known_args()[0].dataset == 'NAB':
    nab_list = ['ec2', 'ambient']
    parser.add_argument('--NAB_data', default=nab_list)
elif parser.parse_known_args()[0].dataset == 'SMAP':
    smap_list = ['A-1']
    parser.add_argument('--SMAP_data', default=smap_list)
elif parser.parse_known_args()[0].dataset == 'MSL':
    msl_list = ['T-9', 'T-13', 'P-11']
    parser.add_argument('--MSL_data', default=msl_list) 
elif parser.parse_known_args()[0].dataset == 'SMD':
    smd_list = ['1-1', '2-4']
    parser.add_argument('--SMD_data', default=smd_list)
elif parser.parse_known_args()[0].dataset == 'WADI':
    wadi_list = []
    parser.add_argument('--WADI_data', default=wadi_list)
```

```python
if self.dataset == 'NAB':
	self.dataset_choice = args.choice_NAB
elif self.dataset == 'SMAP':
	self.dataset_choice = args.choice_SMAP
elif self.dataset == 'MSL':
	self.dataset_choice = args.choice_MSL
elif self.dataset == 'SMD':
	self.dataset_choice = args.choice_SMD 
```

